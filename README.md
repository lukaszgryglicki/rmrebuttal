# rmrebuttal
Use DevStats databases and tools to generate contributors stats

# Data

- Data is generated by single SQL [query](https://github.com/lukaszgryglicki/rmrebuttal/blob/master/query.sql).
- It is processed by `runq` devstats tool and then postprocessed by `rmrebuttal` tool.

# Usage

- You need to have DevStats K8s database and `runq` binary copied to the root directory of this repo.
- Just run `PG_PASS=... ./get_data.sh 10` script to generate Top 10 data for Kubernetes.
- Run `PG_PASS=... PG_DB=prometheus ./get_data.sh 30` script to generate Top 30 data for Prometheus.
- Argument is the N parameter, script analyses Top N developers, contributors, issue creators etc.
- You can also regenerate all data for N=1, 2, 3, 4, 5, 10, 15, 20, 25, 50, 100, 200, 500, 1000 via `PG_PASS=... ./generate_all.sh`.
- You can generate only specific Top N's for a specific project by: `PG_PASS=... NS="1 10 100" PG_DB=prometheus ./generate_all.sh`.
- You can generate data for specific projects (default is all projects) by `PG_PASS=... NS="10 100" PROJS="kubernetes prometheus" ./generate_all.sh`.
- To merge data from multiple Top N analyses, use: `./merge_results.sh`. It will assume default project kubernetes.
- To specify own list of projects use: `PROJS="prometheus allprj" ./merge_results.sh`.
- To select only specific rows use: `RRE="colname;;;regexp" RNAME="name_prefix" ./merge_results.sh`.
- RRE `colname;;;regexp` will be used to select only rows which `colname` matches `regexp`, example:
- `RRE="release;;;(?im)cncf" RNAME="join" PROJS="prometheus allprj" ./merge_results.sh`.
- To have full control on merging use: `PG_DB=projdb ./rmrebuttal nStaticCols 'staticCol1;...;staticColN;dynamicCol1;...;dynamicColN' 'n1;...;N' "colName;;;regexp" output.csv`.
- You can see some examples in `./example_merges.sh`.

# Column format mapping

-  You can specify it by setting COLFMT environment variable as follows:
- `colName1,newName1,type1,fmt1;,,,;colNameN,newNameN,typeN,fmtN`.
- colNameI - required, column name to apply mapping, it can contain '%s' which will be replaced with N if column is dynamic.
- newnameI - new name for column, optional.
- typeI - type of column (to apply format): can be n (numeric), d (datetime), optional.
- fmtI - format of column (if type given), can be Sprintf format for n, or date format for d, optional.
- fmtI for "n" (numeric) column can be for example "%.1f%%".
- fmtI for "d" (datetime) column can be for example: "2006-01-02T15:04:05".
- I = {1,2,...N}.
- Example: `COLFMT="release,Release,,;date_from,Date,d,2006-01-02;top_commits_perc,Percent of top %s committers commits,n,%.1f%%"`.

# Analysis

- Detailed analysis is [here](https://github.com/lukaszgryglicki/rmrebuttal/blob/master/ANALYSIS_RELEASES.md).

# Data sheets and charts

- Top N data and charts are [here](https://docs.google.com/spreadsheets/d/1dK7h8i62G7JEtTrJ2XEYoX0vInEoA7lW0m9ssl5bXag/edit?usp=sharing)
- Contributors data sheets and charts are [here](https://docs.google.com/spreadsheets/d/1EfZEsgfhxUnnOfyHqJO_Uh3aIyDigQkf5bY0AYIrdnE/edit?usp=sharing).
- Committers data sheets and charts are [here](https://docs.google.com/spreadsheets/d/1OY8JHREEZgbvRDFDOplxJJFvEtlcs5TSXbv6JER9_TY/edit?usp=sharing).
- Contributing companies data sheets and charts are [here](https://docs.google.com/spreadsheets/d/1elKts4n5FHzLr9Ob4OUID1MvJ51dmdQDnPP6mgN-O78/edit?usp=sharing).
- Final Kubernetes chart is [here](https://docs.google.com/spreadsheets/d/1tdHqydcDQ7bUWMxHbYADiLmym2UBFcDTUDPCCfRNJuc/edit?usp=sharing).
- Final Prometheus chart is [here](https://docs.google.com/spreadsheets/d/1KtOQRYtflcDVL9FFOJiBxH0adthH5gsIbUPOnFkgIBA/edit?usp=sharing).
